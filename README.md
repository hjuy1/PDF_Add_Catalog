# PDF加目录工具

一个用于给PDF文件添加目录（书签）的Python工具。

## 功能介绍

该工具可以为没有目录的PDF文件添加可点击的目录结构（也称为书签），支持多级目录结构。通过指定目录文本和对应的页码，程序会自动在PDF文件中创建相应的书签结构。

## 使用方法

### 1. 安装依赖

```bash
pip install PyPDF2
```

### 2. 准备目录文本

目录文本需要按照特定格式编写(空格不是必须的)：

```
女儿 P1
  .术士 P1
    ..精零 P1
    ..精一 P2
    ..精二 P3
    ..皮肤 P4
      ...报童 P4
      ...见习联结者 P5
      ...播种者 P6
  .近卫 P7
    ..精二 P7
    ..皮肤 P8
      ...触及星辰 P8
  .医疗 P9
    ..精二 P9
    ..皮肤 P10
      ...寰宇独奏 P10
老婆 P11
  .术士 P11
    ..精一 P11
    ..精二 P12
    ..皮肤 P13
      ...夏卉 FA018 P13
      ...绵绒小魔女 P14
  .医疗 P15
    ..精一 P15
    ..精二 P16
    ..皮肤 P17
      ...远行前的野餐 P17
```

其中：
- 每行表示一个目录项
- 层级关系基于特定字符(self.split_grade，默认为. )在页面名称中的出现次数。目录中不出现. 为一级标题，出现一个. 为二级标题
- 每行末尾使用 `P` + 页码 表示对应页码（可根据需要调整）
- 页码从1开始计算

### 参数说明

- `catalog_str`: 目录字符串，包含目录项和页码信息
- `pdf_path`: 原始PDF文件路径
- `offset`: 页码偏移量（可选，默认为0）
- `split_page`: 页码分隔符（可选，默认为"P"）
- `split_grade`: 层级分隔符（可选，默认为"."）
- `out_path`: 输出文件路径（可选，默认在原文件名后添加"(目录)"）

## 示例

```python
if __name__ == "__main__":
    pdf = Path(r".\sourse.pdf")
    catalog_str = """
    女儿 P1
      .术士 P1
        ..精零 P1
        ..精一 P2
        ..精二 P3
        ..皮肤 P4
          ...报童 P4
          ...见习联结者 P5
          ...播种者 P6
      .近卫 P7
        ..精二 P7
        ..皮肤 P8
          ...触及星辰 P8
      .医疗 P9
        ..精二 P9
        ..皮肤 P10
          ...寰宇独奏 P10
    老婆 P11
      .术士 P11
        ..精一 P11
        ..精二 P12
        ..皮肤 P13
          ...夏卉 FA018 P13
          ...绵绒小魔女 P14
      .医疗 P15
        ..精一 P15
        ..精二 P16
        ..皮肤 P17
          ...远行前的野餐 P17
    """
    Catalog = AddCatalog(catalog_str=catalog_str, pdf_path=pdf)
    Catalog.main()
```

## 注意事项

- 页码从1开始计数
- 层级关系基于特定字符(self.split_grade，默认为. )在页面名称中的出现次数
- 输出文件默认保存在原文件相同目录下，文件名后添加"(目录)"后缀
